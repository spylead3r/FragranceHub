@model WishlistViewModel

<h2>Your Wishlist</h2>



<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.js" integrity="sha512-lbwH47l/tPXJYG9AcFNoJaTMhGvYWhVM9YI43CT+uteTRRaiLCui8snIgyAN8XWgNjNhCqlAUdzZptso6OCoFQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.3/toastr.min.css" integrity="sha512-6S2HWzVFxruDlZxI3sXOZZ4/eJ8AcxkQH1+JjSe/ONCEqR9L4Ysq5JdT5ipqtzU7WHalNwzwBv+iE51gNHJNqQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />


<partial name="_NotificationsPartial" />

@if (Model.Fragrances.Any())
{
    <div class="row">
        @foreach (var fragrance in Model.Fragrances)
        {
            <div class="col-lg-4 col-md-6 col-sm-12 fragrance-card">
                <div class="flip-card fragrance-card">
                    <div class="flip-card-inner">
                        <div class="flip-card-front">
                            <img src="@fragrance.ImageUrl" alt="@fragrance.Name" style="width:300px;height:300px;">
                        </div>
                        <div class="flip-card-back">
                            <h3>@fragrance.Name</h3>
                            <p>Price: @fragrance.Price</p>
                            <button class="remove-from-wishlist-btn" data-fragrance-id="@fragrance.Id">
                                Remove from Wishlist
                            </button>
                            <button class="details-btn btn btn-secondary">Details</button>
                        </div>
                    </div>
                </div>
            </div>
        }
    </div>
}
else
{
    <p>Your wishlist is empty.</p>
}

<script>
    document.addEventListener("DOMContentLoaded", async function () {
        const removeButtons = document.querySelectorAll(".remove-from-wishlist-btn");
        removeButtons.forEach(button => {
            button.addEventListener("click", async function () {
                const fragranceId = button.getAttribute("data-fragrance-id");

                // Output to the browser console to track the progress
                console.log("Button clicked for fragrance ID:", fragranceId);

                try {
                    const response = await fetch(`/Wishlist/Remove?fragranceId=${fragranceId}`, {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        }
                    });

                    if (response.ok) {
                        button.classList.remove("active");

                        toastr.success('The fragrance was successfully removed.');
                    } else {
                        console.error("Failed to remove fragrance from wishlist.");
                    }
                } catch (error) {

                    console.error("An error occurred while removing fragrance from wishlist:", error);
                }
            });
        });

        // Toastr initialization
        toastr.options = {
            closeButton: true,
            preventDuplicates: true,
            positionClass: 'toast-bottom-right',
            showMethod: 'slideDown',
            timeOut: 4000
        };

        // Display a Toastr message
    });
</script>





